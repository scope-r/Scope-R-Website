!function(r){var a={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgb(255,255,255)"],shadeVariation:!1,shadePercentage:0,shadeColors:{light:"rgb(255,255,255)",dark:"rgb(0,0,0)"},normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"},transparent:null};function t(r,a){var t=r.split(","),e=a<0?0:255,n=a<0?-1*a:a,o=parseInt(t[0].slice(4)),s=parseInt(t[1]),c=parseInt(t[2]);return"rgb("+(Math.round((e-o)*n)+o)+","+(Math.round((e-s)*n)+s)+","+(Math.round((e-c)*n)+c)+")"}function e(r,a,t){var e=r.split(","),n=a.split(","),o=parseInt(e[0].slice(4)),s=parseInt(e[1]),c=parseInt(e[2]);return"rgb("+(Math.round((parseInt(n[0].slice(4))-o)*t)+o)+","+(Math.round((parseInt(n[1])-s)*t)+s)+","+(Math.round((parseInt(n[2])-c)*t)+c)+")"}!function(r,a){"use strict";var t=function(r,a){var t=new Image,e=r.src||r;"data:"!==e.substring(0,5)&&(t.crossOrigin="Anonymous"),t.onload=function(){var r=function(r,a){var t=document.createElement("canvas");return t.setAttribute("width",r),t.setAttribute("height",a),t.getContext("2d")}(t.width,t.height);r.drawImage(t,0,0);var e=r.getImageData(0,0,t.width,t.height);a&&a(e.data)},t.src=e},e=function(r){return["rgb(",r,")"].join("")},n=function(r){var a=[];for(var t in r)a.push(s(t,r[t]));return a.sort(function(r,a){return a.count-r.count}),a},o=function(r,a){if(r.length>a)return r.slice(0,a);for(var t=r.length-1;a-1>t;t++)r.push(s("0,0,0",0));return r},s=function(r,a){return{name:e(r),count:a}},c={colors:function(r,a){var s=(a=a||{}).exclude||[],c=a.paletteSize||10;t(r,function(r){for(var t={},i="",u=[],l=0;l<r.length;l+=4)u[0]=r[l],u[1]=r[l+1],u[2]=r[l+2],i=u.join(","),-1===u.indexOf(void 0)&&0!==r[l+3]&&-1===s.indexOf(e(i))&&(t[i]=i in t?t[i]+1:1);if(a.success){var d=o(n(t),c+1);a.success({dominant:d[0].name,secondary:d[1].name,palette:d.map(function(r){return r.name}).slice(1)})}})}};r.RGBaster=r.RGBaster||c}(window),r.adaptiveBackground={run:function(n){var o=r.extend({},a,n);r(o.selector).each(function(a,n){var s=r(this),c=function(r){var a=r.match(/\d+/g);return(299*a[0]+587*a[1]+114*a[2])/1e3},i=function(){var r=s.attr("data-ab-css-background");return void 0!==r&&!1!==r},u=function(){var r=s.css("background-image");return/\(([^)]+)\)/.exec(r)[1].replace(/"/g,"")};s.on("ab-color-found",function(a,n){var u,l;if(u=o.parent&&s.parents(o.parent).length?s.parents(o.parent):s.attr("data-ab-parent")&&s.parents(s.attr("data-ab-parent")).length?s.parents(s.attr("data-ab-parent")):i()?s:o.parent?s.parents(o.parent):s.parent(),o.shadeVariation&&(n.color=(l=n.color,1==o.shadeVariation?c(l)<=128?t(l,o.shadePercentage):t(l,-o.shadePercentage,o.shadePercentage):"blend"==o.shadeVariation?c(l)>=128?e(l,o.shadeColors.dark,o.shadePercentage):e(l,o.shadeColors.light,o.shadePercentage):void 0)),r.isNumeric(o.transparent)&&null!=o.transparent&&o.transparent>=.01&&o.transparent<=.99){var d=n.color.replace("rgb","rgba").replace(")",", "+o.transparent+")");u.css({backgroundColor:d})}else u.css({backgroundColor:n.color});o.normalizeTextColor&&u.css({color:function(r){return c(r)>=128?o.normalizedTextColors.dark:o.normalizedTextColors.light}(n.color)}),u.addClass(function(r){return c(r)<=128?o.lumaClasses.dark:o.lumaClasses.light}(n.color)).attr("data-ab-yaq",c(n.color)),o.success&&o.success(s,n)}),function(){if("PICTURE"==s[0].tagName){var r=s[0].children;for(var a in r)if("IMG"==r[a].tagName){var t=r[a];break}t.currentSrc&&(t=t.currentSrc)}else t=i()?u():s[0];RGBaster.colors(t,{paletteSize:20,exclude:o.exclude,success:function(r){s.attr("data-ab-color",r.dominant),s.trigger("ab-color-found",{color:r.dominant,palette:r.palette})}})}()})}}}(jQuery);